<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>markAI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body class="bg-info">
    <div class="navbar bg-dark text-light px-3 fs-3">
        markAI
    </div>
    <div class="container mt-4 p-3 bg-light shadow rounded-2">
        markAI will automatically grade your essays and give you feedback on how to improve your writing. markAI is based on the GPT-4 language model from OpenAI. It is trained on a large corpus of essays and can grade your essay based on the quality of your writing. It can also give you feedback on how to improve your writing. To get started, enter your essay below and click submit.
    </div>
    <div class="container mt-2 mb-4 p-3 bg-light shadow rounded-2">
        <h2>Enter your essay:</h2>
        <form action="/" method="post" id="essay-form">
            <textarea type="text" class="form-control" style="max-height: 500px; min-height: 200px; overflow-y: auto" name="user_question" placeholder="Enter text..." required>{% if prompt %}{{ prompt }}{% endif %}</textarea>
            <button type="submit" class="btn btn-primary mt-2">Submit</button>
        </form>
        <div class="text-center" id="loading-spinner" style="display:none;">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Grading...</p>
        </div>
        {% if response %}
            <div class="container mt-3 p-3 bg-white shadow rounded-2" id="openai-response">
                <div class="response-content p-2" style="white-space: normal;">
                    <h3>Score: {{ response['Numerical_Score'] }} / 100</h3>
                    <div>
                        <ul style="list-style-type: none;">
                            {% for feedback in response['Comments'] %}
                                <li class="py-1"><strong>{{ feedback }}</strong> : {{ response['Comments'][feedback] }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <h3>Overall:</h3>
                    <p>{{ response['Overall_Feedback'] }}</p>
                </div>
            </div>
        {% endif %}
    </div>
    <script>
        document.getElementById('essay-form').onsubmit = function() {
            document.getElementById('loading-spinner').style.display = 'block';
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>